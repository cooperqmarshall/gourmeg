{{ define "body" }}
<div id="content" class="bg-gray-50 text-gray-800 shadow-lg rounded-lg p-3 md:p-8 mx-3">
    {{ template "recipe" . }}
</div>
{{ end }}

{{ define "recipe" }}
<div class="relative h-36 md:h-72 rounded-t-lg overflow-hidden">
    <img src="{{ .ImageUrl }}" alt="{{ .Name }}" class="object-cover w-full h-full" />
    <div class="absolute inset-0 top-24 bg-gradient-to-t from-gray-50 to-transparent"></div>
    <div class="absolute bottom-0 left-0 w-full px-2 bg-gradient-to-t from-gray-50 via-grey-100 to-transparent">
        <h1 class="text-2xl md:text-3xl drop-shadow-lg">
            <a href="{{ .Url }}" target="_blank" class="hover:underline">{{ .Name }}</a>
        </h1>

        <button class="shrink underline" hx-put="/recipe/refetch/{{ .Id }}" hx-target="body">refetch</button>
    </div>
</div>
<div class="mx-2 mb-2 flex flex-wrap items-center gap-2 text-sm">
    <span class="font-medium">Part of:</span>
    {{ range .Lists }}
    <a href="/list/{{ .Id }}" class="px-2 py-1 bg-carnation-pink-100 border border-carnation-pink-900 rounded-full">
        {{ .Name }}
    </a>
    {{ end }}
    <button class="px-2 py-1 border border-dashed border-carnation-pink-900 rounded-full"
        hx-get="/recipe/{{ .Id }}/edit-lists" hx-target="#content">
        edit lists
    </button>
</div>
<hr class="mx-2" />
<div class="mx-2 my-2">
    <h2 class="text-xl">Ingredients:</h2>
    <ul class="list-disc list-inside space-y-1">
        {{ range $i := .Ingredients }}
        <li>{{ $i }}</li>
        {{ else }}
        <li class="text-gray-500 italic">No ingredients listed.</li>
        {{ end }}
        {
    </ul>
    <br />
    <h2 class="text-xl">Instructions:</h2>
    <ol class="list-decimal list-inside space-y-1">
        {{ range $i := .Instructions }}
        <li class="py-1">{{$i}}</li>
        {{ else }}
        <li class="text-gray-500 italic">No instructions listed.</li>
        {{ end }}
    </ol>
</div>
{{ end }}

{{ define "edit-lists" }}
<form class="flex flex-col" hx-put="/recipe/{{ .Id }}/lists">
<h1 class="text-3xl font-bold border-b pb-2 mb-4 md:pb-4 md:mb-6 text-center">Gfdgsa</h1>
    <ul class="space-y-1">
        {{ range .Lists.Lists }}
        {{ template "edit-tree" . }}
        {{ end }}
    </ul>
    <button type="submit"
        class="text-center px-2 py-1 mx-auto rounded-sm bg-carnation-pink-100 border border-carnation-pink-900">Save</button>
</form>
{{ end }}

{{ define "edit-tree" }}
<li>
    <label class="flex justify-between items-center rounded-sm has-checked:bg-jordy-blue-100">
        <input type="checkbox" name="list_ids" value={{ .Id }} {{ if .HasItem }}checked{{ end }}>
        <span class="pl-1">{{ .Name }}</span>
        <span class="h-2 mx-1 border-b-2 border-dotted border-gray-300 grow"></span>
        <span class="text-gray-500">{{ len .Recipes }}</span>
    </label>
    {{ if .Lists }}
    <ul class="ml-1 pt-2 pl-3 mb-3 border-l space-y-1">
        {{ range .Lists }}
        {{ template "edit-tree" . }}
        {{ end }}
    </ul>
    {{ end }}
</li>
{{ end }}
