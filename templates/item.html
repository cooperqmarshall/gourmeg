{{ define "list_of_items" }}
<ul id="list-children" class="flex flex-wrap justify-evenly">
    {{ range . }} {{ template "item" . }} {{ else }} {{ end }}
</ul>
{{ end }}

{{ define "item" }}
<li class="my-1 sm:my-2 w-full sm:w-5/12 max-w-sm bg-white drop-shadow-sm shadow-sm rounded-sm overflow-hidden" hx-target="this" hx-swap="outerHTML">
    <a href="/{{ .Type }}/{{ .Id }}">
        <img class="w-full h-48 object-cover border-l-4 border-turquoise" src="{{ .ThumbnailUrl }}">
    </a>
    <div class="bg-jordy-blue h-1"></div>
    <div class="px-2 py-1 flex gap-1">
        <div class="grow w-full truncate">
            <a href="/{{ .Type }}/{{ .Id }}">{{ .Name }}</a>
            <p class="text-sm text-gray-700">
                {{ if eq .Type "list" }} List
                {{ else if .Domain }}{{ .Domain }}
                {{ else }} Domain {{ end }}
            </p>
        </div>
        <button class="text-sm underline" hx-get="/item/{{ .Id }}/edit?name={{ urlquery .Name }}&type={{ urlquery .Type }}">
            edit
        </button>
    </div>
</li>
{{ end }}

{{ define "edit_item" }}
<li class="py-1" hx-target="this" hx-swap="outerHTML">
    <input class="bg-gray-50 ring-1 ring-gray-300 text-gray-900 rounded-sm focus:ring-blue-500" name="name"
        value="{{ .Name }}" />
    <button class="underline" hx-get="/item/{{ .Id }}?type={{ .Type }}">
        cancel
    </button>
    <button class="underline" hx-put="/item/{{ .Type }}/{{ .Id }}" hx-include="closest li">
        confirm
    </button>
    <button class="underline" hx-delete="/item/{{ .Type }}/{{ .Id }}" hx-confirm="Are you sure?">
        delete
    </button>
</li>
{{ end }}

{{ define "add_item_options" }}
<li class="w-full" hx-target="this" hx-swap="outerHTML">
    <button class='underline' hx-get='/item/list/add?parent_id={{ . }}'> + Add List</button>
    or
    <button class='underline' hx-get='/item/recipe/add?list_id={{ . }}'> + Add Recipe</button>
</li>
{{ end }}

{{ define "add_item_options_and_items" }}
    {{ template "add_item_options" .Id }}
    {{ range .Children }} {{ template "item" . }} {{ else }} {{ end }}
{{ end }}

{{ define "add_list_item" }}
<form id="add-list-form" hx-target="this" hx-swap="outerHTML">
    <label for="name">List Name:</label>
    <input class="bg-gray-50 ring-1 ring-gray-300 text-gray-900 rounded-sm focus:ring-blue-500" name="name" />
    <button class="underline" hx-get="/item/add_item_options?id={{ . }}"> cancel </button>
    <button class="underline" hx-post="/list?parent_id={{ . }}"> add </button>
</form>
{{ end }}

{{ define "add_recipe_item" }}
<form hx-target="this" hx-swap="outerHTML" hx-target="this">
    <label for="name">Recipe Url:</label>
    <input class="bg-gray-50 ring-1 ring-gray-300 text-gray-900 rounded-sm focus:ring-blue-500" name="url" />
    <button class="underline" hx-get="/item/add_item_options?id={{ . }}"> cancel </button>
    <button class="underline" hx-post="/recipe?list_id={{ . }}"> add </button>
</form>
{{ end }}

{{ define "duplicate_recipe_confirm" }}
<li class="py-1" hx-swap="outerHTML" hx-target="this">
    <form id="add-recipe-form">
        <input type="hidden" name="url" value="{{ .Url }}" />
    </form>
    <p>Recipe "{{ .Name }}" already added to "{{ .List }}".</p>
    <p>Do you still want to add it?</p>
    <button class="underline" hx-get="/item/add_item_options?id={{ .ListId }}">
        cancel
    </button>
    <button class="underline" hx-post="/recipe?list_id={{ .ListId }}&ignore_duplicates=true"
        hx-include="#add-recipe-form">
        add
    </button>
</li>
{{ end }}

{{ define "list_item" }}
<li class="my-1 sm:my-2 w-full sm:w-5/12 max-w-sm bg-white drop-shadow-sm shadow-sm" hx-target="this" hx-swap="outerHTML">
    <a href="/list/{{ .Id }}" class="block p-3">
        <div class="flex justify-between items-start">
            <div class="grow w-full truncate">
                <h3 class="font-semibold truncate">{{ .Name }}</h3>
                <p class="text-gray-700 text-sm truncate">
                    {{ if .Lists }}{{ len .Lists }} items{{ else }}Empty list{{ end }}
                </p>
            </div>
            <button 
                class="underline text-sm" 
                hx-get="/item/{{ .Id }}/edit?name={{ urlquery .Name }}&type=list">
                edit
            </button>
        </div>
    </a>
    <div class="bg-turquoise h-1"></div>
</li>
{{ end }}
